<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ú–µ–º–æ—Ä–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }

        body {
            font-family: 'Comic Sans MS', 'Arial Rounded MT Bold', sans-serif;
            background: url('img/body.jpg') no-repeat center center fixed;
            background-size: cover;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 5px;
            touch-action: manipulation;
            overflow-x: hidden;
            position: relative;
        }

        /* –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞ –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.85);
            z-index: -1;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            text-align: center;
            display: flex;
            flex-direction: column;
            height: 100vh;
            max-height: -webkit-fill-available;
            position: relative;
            z-index: 1;
        }

        h1 {
            color: #1565c0;
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            margin-bottom: 3px;
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.9);
            padding: 5px;
            line-height: 1.1;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            margin-top: 5px;
            border: 2px solid #ffcc00;
        }

        .subtitle {
            color: #ff6b35;
            font-size: clamp(0.9rem, 3vw, 1.4rem);
            margin-bottom: 6px;
            font-weight: bold;
            padding: 6px 10px;
            line-height: 1.1;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            border: 2px solid #42a5f5;
        }

        .game-info {
            display: flex;
            justify-content: space-around;
            background: rgba(255, 255, 255, 0.95);
            padding: clamp(8px, 2vw, 15px);
            border-radius: 15px;
            margin: 5px auto 10px;
            width: 95%;
            max-width: 500px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
            border: clamp(2px, 1vw, 4px) solid #ffcc00;
            font-size: clamp(0.9rem, 3.5vw, 1.3rem);
            color: #2c3e50;
            flex-shrink: 0;
            backdrop-filter: blur(5px);
        }

        .game-board-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 3px;
            width: 100%;
            min-height: 0;
            margin-bottom: 5px;
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(4, 1fr);
            gap: clamp(6px, 1.5vw, 12px);
            width: 100%;
            height: 100%;
            max-width: 700px;
            max-height: 700px;
            margin: 0 auto;
            padding: 8px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 20px;
            border: 4px solid #42a5f5;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        .card {
            width: 100%;
            height: 100%;
            border-radius: 15px;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            min-height: 70px;
            -webkit-tap-highlight-color: transparent;
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .card.matched {
            cursor: default;
        }

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: clamp(3px, 1vw, 6px) solid white;
        }

        .card-front {
            background: #ffcc00;
            transform: rotateY(180deg);
            padding: 2%;
        }

        .card-front img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            pointer-events: none;
        }
        
        .card-back {
            background: linear-gradient(135deg, #42a5f5 0%, #2196f3 100%);
            padding: 8%;
        }
        
        .card-back::before {
            content: '?';
            position: absolute;
            font-size: clamp(1.5rem, 4vw, 3rem);
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .controls {
            margin-top: auto;
            padding: 8px 0 10px;
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-shrink: 0;
            width: 100%;
            position: relative;
            z-index: 10;
        }

        button {
            background: linear-gradient(135deg, #ff6b35 0%, #ff8a50 100%);
            color: white;
            border: none;
            padding: clamp(8px, 2vw, 12px) clamp(15px, 4vw, 20px);
            font-size: clamp(0.9rem, 3vw, 1.2rem);
            border-radius: 40px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
            font-weight: bold;
            min-width: 110px;
            max-width: 40%;
            min-height: 40px;
            touch-action: manipulation;
            border: 2px solid white;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.25);
        }

        button:active {
            transform: scale(0.95);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .win-message {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            color: white;
            text-align: center;
            padding: 20px;
        }

        .win-message h2 {
            color: #ffcc00;
            font-size: clamp(2rem, 6vw, 3.5rem);
            margin-bottom: 15px;
            text-shadow: 0 0 15px rgba(255, 204, 0, 0.7);
            line-height: 1.2;
        }

        .win-message p {
            font-size: clamp(1.2rem, 4vw, 2rem);
            margin-bottom: 10px;
            color: #bbdefb;
            line-height: 1.3;
        }

        #play-again-btn {
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);
            min-width: 200px;
            min-height: 50px;
        }

        .quiz-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 15px;
        }

        .quiz-content {
            background: white;
            border-radius: 25px;
            padding: 20px;
            max-width: 450px;
            width: 95%;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            border: 5px solid #ffcc00;
            background: rgba(255, 255, 255, 0.98);
        }

        .quiz-header {
            text-align: center;
            margin-bottom: 15px;
        }

        .quiz-header-icon {
            font-size: 3rem;
            color: #ff6b35;
            margin-bottom: 8px;
            cursor: pointer; /* –î–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏—è –∑–≤—É–∫–∞ */
        }

        .quiz-question {
            font-size: clamp(1.1rem, 3.5vw, 1.5rem);
            color: #1565c0;
            margin-bottom: 20px;
            font-weight: bold;
            padding: 8px;
            background: rgba(187, 222, 251, 0.3);
            border-radius: 12px;
            text-align: center;
        }

        .quiz-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }

        .quiz-option {
            background: linear-gradient(135deg, #bbdefb 0%, #90caf9 100%);
            border: 3px solid #42a5f5;
            border-radius: 20px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 80px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        }

        .quiz-option img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            pointer-events: none;
        }

        .quiz-option:hover {
            background: linear-gradient(135deg, #90caf9 0%, #64b5f6 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
        }

        .quiz-option:active {
            transform: translateY(0);
        }
        
        /* –î–æ–±–∞–≤–ª–µ–Ω —Å—Ç–∏–ª—å –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∫–ª–∏–∫–æ–≤ */
        .quiz-option.disabled {
            opacity: 0.6;
            cursor: not-allowed;
            pointer-events: none !important;
        }

        .quiz-option.correct {
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);
            border-color: #2E7D32;
        }

        .quiz-option.wrong {
            background: linear-gradient(135deg, #f44336 0%, #c62828 100%);
            border-color: #c62828;
        }

        .quiz-feedback {
            font-size: clamp(1rem, 3vw, 1.4rem);
            font-weight: bold;
            margin-top: 12px;
            min-height: 25px;
            text-align: center;
            padding: 8px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.9);
        }

        .quiz-feedback.correct {
            color: #4CAF50;
            background: rgba(76, 175, 80, 0.1);
        }

        .quiz-feedback.wrong {
            color: #f44336;
            background: rgba(244, 67, 54, 0.1);
        }

        .card.matched .card-front {
            box-shadow: 0 0 12px 5px rgba(76, 175, 80, 0.6);
        }

        /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        @media (max-width: 480px) {
            .game-board {
                grid-template-columns: repeat(2, 1fr);
                grid-template-rows: repeat(6, 1fr);
                gap: 5px;
                padding: 6px;
                max-width: 95%;
            }

            .container {
                padding: 3px;
            }

            button {
                min-width: 100px;
                padding: 8px 12px;
                font-size: 0.9rem;
                min-height: 35px;
            }

            .quiz-content {
                padding: 15px;
            }

            .quiz-options {
                gap: 6px;
            }

            .quiz-option {
                padding: 8px;
                min-height: 70px;
            }
            
            .quiz-header-icon {
                font-size: 2.5rem;
            }
            
            .game-info {
                margin-bottom: 8px;
            }
        }

        @media (max-width: 360px) {
            .game-board {
                gap: 4px;
            }

            .card {
                min-height: 60px;
            }

            button {
                min-width: 90px;
                font-size: 0.8rem;
                padding: 7px 10px;
            }
            
            .quiz-options {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .quiz-question {
                font-size: 1rem;
                padding: 6px;
            }
        }

        @media (max-height: 600px) and (orientation: landscape) {
            .container {
                height: auto;
                min-height: 100vh;
            }

            .game-board {
                grid-template-columns: repeat(4, 1fr);
                grid-template-rows: repeat(3, 1fr);
                max-height: 65vh;
                margin-bottom: 3px;
            }

            .game-info {
                margin: 3px auto 6px;
                padding: 6px 10px;
                font-size: 0.9rem;
            }

            h1 {
                margin-bottom: 2px;
                font-size: 1.4rem;
                padding: 6px;
            }

            .subtitle {
                font-size: 1rem;
                padding: 5px 8px;
                margin-bottom: 4px;
            }

            .controls {
                padding: 5px 0 8px;
            }

            button {
                padding: 6px 10px;
                min-width: 90px;
                min-height: 35px;
                font-size: 0.9rem;
            }
            
            .quiz-content {
                padding: 12px;
                max-width: 400px;
            }
            
            .quiz-option {
                min-height: 60px;
                padding: 8px;
            }
        }

        @media (max-height: 500px) and (orientation: landscape) {
            .game-board {
                grid-template-columns: repeat(6, 1fr);
                grid-template-rows: repeat(2, 1fr);
                max-height: 60vh;
            }

            h1 {
                font-size: 1.2rem;
                padding: 4px;
            }

            .subtitle {
                font-size: 0.9rem;
                padding: 4px 6px;
            }

            .game-info {
                font-size: 0.8rem;
                padding: 4px 8px;
                margin-bottom: 4px;
            }
            
            .controls {
                padding: 4px 0 6px;
            }
        }

        @media (min-width: 1024px) and (min-height: 768px) {
            .game-board {
                gap: 15px;
                max-width: 800px;
                max-height: 800px;
            }

            .card {
                min-height: 100px;
            }
            
            .quiz-option {
                min-height: 100px;
            }
            
            button {
                min-width: 140px;
                padding: 12px 25px;
                font-size: 1.2rem;
                min-height: 45px;
            }
        }

        @supports (-webkit-touch-callout: none) {
            .container {
                height: -webkit-fill-available;
            }
        }

        .no-select {
            -webkit-user-select: none;
            user-select: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="no-select">–ú–µ–º–æ—Ä–∏: –¶–∏—Ñ—Ä—ã 1-6</h1>
        <div class="subtitle no-select">–ù–∞–π–¥–∏ –ø–∞—Ä—ã –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Ü–∏—Ñ—Ä</div>

        <div class="game-info no-select">
            <div class="pairs">–ü–∞—Ä—ã: <span id="pairs-count">0</span>/6</div>
            <div class="moves">–•–æ–¥—ã: <span id="moves-count">0</span></div>
        </div>

        <div class="game-board-container">
            <div class="game-board" id="game-board">
                </div>
        </div>

        <div class="controls">
            <button id="restart-btn" class="no-select">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
            <button id="sound-btn" class="no-select">–ó–≤—É–∫: –í–∫–ª</button>
        </div>
    </div>

    <div class="quiz-modal" id="quiz-modal">
        <div class="quiz-content">
            <div class="quiz-header">
                <div class="quiz-header-icon" id="replay-sound-btn">üîä</div>
            </div>
            <div class="quiz-question" id="quiz-question">
                –ö–∞–∫–æ–π —Ü–∏—Ñ—Ä–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —ç—Ç–æ—Ç –∑–≤—É–∫?
            </div>
            <div class="quiz-options" id="quiz-options">
                </div>
            <div class="quiz-feedback" id="quiz-feedback"></div>
        </div>
    </div>

    <div class="win-message" id="win-message">
        <h2 class="no-select">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! üéâ</h2>
        <p class="no-select">–¢—ã –Ω–∞—à—ë–ª –≤—Å–µ –ø–∞—Ä—ã —Ü–∏—Ñ—Ä!</p>
        <p class="no-select">–•–æ–¥—ã: <span id="final-moves">0</span></p>
        <button id="play-again-btn" class="no-select">–ò–≥—Ä–∞—Ç—å –µ—â—ë —Ä–∞–∑!</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
            const gameBoard = document.getElementById('game-board');
            const movesCount = document.getElementById('moves-count');
            const pairsCount = document.getElementById('pairs-count');
            const restartBtn = document.getElementById('restart-btn');
            const soundBtn = document.getElementById('sound-btn');
            const winMessage = document.getElementById('win-message');
            const finalMoves = document.getElementById('final-moves');
            const playAgainBtn = document.getElementById('play-again-btn');

            // –≠–ª–µ–º–µ–Ω—Ç—ã –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            const quizModal = document.getElementById('quiz-modal');
            const quizQuestion = document.getElementById('quiz-question');
            const quizOptions = document.getElementById('quiz-options');
            const quizFeedback = document.getElementById('quiz-feedback');
            const replaySoundBtn = document.getElementById('replay-sound-btn');

            // –î–∞–Ω–Ω—ã–µ —Ü–∏—Ñ—Ä
            const numbers = [
                {
                    id: '1',
                    name: '–û–¥–∏–Ω',
                    image: 'img/1.png',
                    sound: 'audio/1.wav',
                },
                {
                    id: '2',
                    name: '–î–≤–∞',
                    image: 'img/2.png',
                    sound: 'audio/2.wav',
                },
                {
                    id: '3',
                    name: '–¢—Ä–∏',
                    image: 'img/3.png',
                    sound: 'audio/3.wav',
                },
                {
                    id: '4',
                    name: '–ß–µ—Ç—ã—Ä–µ',
                    image: 'img/4.png',
                    sound: 'audio/4.wav',
                },
                {
                    id: '5',
                    name: '–ü—è—Ç—å',
                    image: 'img/5.png',
                    sound: 'audio/5.wav',
                },
                {
                    id: '6',
                    name: '–®–µ—Å—Ç—å',
                    image: 'img/6.png',
                    sound: 'audio/6.wav',
                }
            ];

            // –°–ª–æ–≤–∞—Ä—å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
            const numbersDict = {};
            numbers.forEach(number => {
                numbersDict[number.id] = number;
            });

            // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
            let cards = [];
            let flippedCards = [];
            let moves = 0;
            let matchedPairs = 0;
            let canFlip = true;
            let soundEnabled = true;
            let currentQuizNumber = null;
            let currentMatchedCards = [];
            let isQuizActive = false;
            let quizAttempts = 0;
            let currentSoundId = null; // ID —Ü–∏—Ñ—Ä—ã, —á–µ–π –∑–≤—É–∫ —Å–µ–π—á–∞—Å –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç—Å—è –≤ –≤–∏–∫—Ç–æ—Ä–∏–Ω–µ
            let isSoundPlaying = false; // –§–ª–∞–≥ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –Ω–∞–ª–æ–∂–µ–Ω–∏—è –∞—É–¥–∏–æ

            // –ê—É–¥–∏–æ –æ–±—ä–µ–∫—Ç—ã –¥–ª—è —Ü–∏—Ñ—Ä
            let numberSounds = {};

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è touch —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
            function isTouchDevice() {
                return 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—É–¥–∏–æ
            function initAudio() {
                try {
                    // –ó–≤—É–∫–∏ –¥–ª—è —Ü–∏—Ñ—Ä
                    numbers.forEach(number => {
                        numberSounds[number.id] = createAudio(number.sound, 0.7);
                    });
                    
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∞—É–¥–∏–æ:', e);
                    soundEnabled = false;
                    soundBtn.textContent = '–ó–≤—É–∫: –ù–µ—Ç';
                }
            }

            // –°–æ–∑–¥–∞–Ω–∏–µ –∞—É–¥–∏–æ –æ–±—ä–µ–∫—Ç–∞
            function createAudio(src, volume = 0.7) {
                try {
                    const audio = new Audio(src);
                    audio.volume = volume;
                    audio.preload = 'auto';
                    audio.addEventListener('error', (e) => {
                        console.warn(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∞—É–¥–∏–æ: ${src}`);
                    });
                    return audio;
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∞—É–¥–∏–æ:', e);
                    return null;
                }
            }

            // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ —Ü–∏—Ñ—Ä—ã (–¥–ª—è –ø–µ—Ä–µ–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫)
            function playNumberSound(numberId) {
                if (!soundEnabled || !numberSounds[numberId]) return;

                try {
                    const sound = numberSounds[numberId];
                    const soundClone = sound.cloneNode();
                    soundClone.volume = sound.volume;
                    soundClone.play().catch(e => {
                        if (e.name !== 'NotAllowedError') {
                            console.log('–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–≤—É–∫–∞:', e);
                        }
                    });
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–≤—É–∫–∞:', e);
                }
            }

            // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–∞ —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –Ω–∞–ª–æ–∂–µ–Ω–∏—è
            function playQuizSound(numberId) {
                if (!soundEnabled || isSoundPlaying || !numberSounds[numberId]) return;

                isSoundPlaying = true;
                
                // –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è, —á—Ç–æ –∑–≤—É–∫ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç—Å—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ –ø–æ–ª–µ–∑–Ω–æ)
                const soundIcon = document.getElementById('replay-sound-btn');
                if (soundIcon) soundIcon.style.color = '#1565c0'; 

                try {
                    const sound = numberSounds[numberId];
                    const soundClone = sound.cloneNode();
                    soundClone.volume = sound.volume;
                    
                    // –°–±—Ä–æ—Å —Ñ–ª–∞–≥–∞ –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∑–≤—É–∫–∞
                    soundClone.onended = () => {
                        isSoundPlaying = false;
                        if (soundIcon) soundIcon.style.color = '#ff6b35'; 
                    };

                    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
                    soundClone.onerror = () => {
                        console.error('–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–≤—É–∫–∞ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã');
                        isSoundPlaying = false;
                        if (soundIcon) soundIcon.style.color = '#ff6b35'; 
                    };

                    soundClone.play().catch(e => {
                        if (e.name !== 'NotAllowedError') {
                            console.log('–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–≤—É–∫–∞ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã:', e);
                        }
                        isSoundPlaying = false;
                        if (soundIcon) soundIcon.style.color = '#ff6b35'; 
                    });
                    
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–≤—É–∫–∞ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã:', e);
                    isSoundPlaying = false;
                    if (soundIcon) soundIcon.style.color = '#ff6b35'; 
                }
            }
            
            // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∑–≤—É–∫–∞ —Ü–∏—Ñ—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–∞
            function playRandomQuizSound() {
                const randomNumber = Math.floor(Math.random() * 6) + 1;
                currentSoundId = randomNumber.toString(); // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º ID, —á–µ–π –∑–≤—É–∫ –ø—Ä–æ–∏–≥—Ä–∞–ª–∏
                playQuizSound(currentSoundId);
            }

            // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫
            function createCards() {
                let cardPairs = [];
                numbers.forEach(number => {
                    cardPairs.push(number.id);
                    cardPairs.push(number.id);
                });

                // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏
                for (let i = cardPairs.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [cardPairs[i], cardPairs[j]] = [cardPairs[j], cardPairs[i]];
                }

                // –û—á–∏—â–∞–µ–º –∏–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ
                gameBoard.innerHTML = '';

                // –°–æ–∑–¥–∞–µ–º HTML –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏
                cardPairs.forEach((numberId, index) => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.dataset.number = numberId;
                    card.dataset.index = index;

                    card.innerHTML = `
                        <div class="card-front">
                            <img src="img/${numberId}.png" alt="–¶–∏—Ñ—Ä–∞ ${numberId}" loading="lazy" onerror="this.style.display='none'; this.parentElement.innerHTML='<span style=\\'font-size: 2rem; font-weight: bold;\\'>${numberId}</span>';">
                        </div>
                        <div class="card-back">
                        </div>
                    `;

                    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
                    if (isTouchDevice()) {
                        card.addEventListener('touchstart', handleCardTouch, { passive: true });
                        card.addEventListener('click', handleCardClick);
                    } else {
                        card.addEventListener('click', handleCardClick);
                    }

                    gameBoard.appendChild(card);
                });

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ –≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏
                cards = Array.from(document.querySelectorAll('.card'));
                canFlip = true;
                isQuizActive = false;
                quizAttempts = 0;
            }

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è touch —É—Å—Ç—Ä–æ–π—Å—Ç–≤
            function handleCardTouch(e) {
                e.preventDefault();
                if (!canFlip || isQuizActive) return;
                const card = e.currentTarget;
                flipCard(card);
            }

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è click
            function handleCardClick(e) {
                if (!canFlip || isQuizActive) return;
                const card = e.currentTarget;
                flipCard(card);
            }

            // –ü–µ—Ä–µ–≤–æ—Ä–æ—Ç –∫–∞—Ä—Ç–æ—á–∫–∏
            function flipCard(card) {
                if (card.classList.contains('flipped') || card.classList.contains('matched')) {
                    return;
                }

                if (flippedCards.length === 2) {
                    return;
                }

                card.classList.add('flipped');
                flippedCards.push(card);
                
                // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫ —Ü–∏—Ñ—Ä—ã
                playNumberSound(card.dataset.number);

                if (flippedCards.length === 2) {
                    moves++;
                    movesCount.textContent = moves;
                    canFlip = false;

                    setTimeout(checkMatch, 500);
                }
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫
            function checkMatch() {
                const card1 = flippedCards[0];
                const card2 = flippedCards[1];

                if (card1.dataset.number === card2.dataset.number) {
                    card1.classList.add('matched');
                    card2.classList.add('matched');
                    
                    currentMatchedCards = [card1, card2];
                    currentQuizNumber = card1.dataset.number;

                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ—Å—Ç —á–µ—Ä–µ–∑ 300–º—Å
                    setTimeout(showQuiz, 300);

                } else {
                    setTimeout(() => {
                        card1.classList.remove('flipped');
                        card2.classList.remove('flipped');
                        canFlip = true;
                    }, 800);
                }

                flippedCards = [];
            }

            // –ü–æ–∫–∞–∑ —Ç–µ—Å—Ç–∞
            function showQuiz() {
                isQuizActive = true;
                quizAttempts = 0;
                
                // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º —Å–ª—É—á–∞–π–Ω—ã–π –∑–≤—É–∫ –∏ –∑–∞–ø–æ–º–∏–Ω–∞–µ–º –µ–≥–æ ID
                playRandomQuizSound();

                quizQuestion.textContent = '–ö–∞–∫–æ–π —Ü–∏—Ñ—Ä–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —ç—Ç–æ—Ç –∑–≤—É–∫?';

                quizOptions.innerHTML = '';
                quizFeedback.textContent = '';
                quizFeedback.className = 'quiz-feedback';

                generateNewQuizOptions();

                quizModal.style.display = 'flex';
            }
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 3 –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ—Ç–≤–µ—Ç–∞: 1 –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (—Ç–µ–∫—É—â–∏–π –∑–≤—É–∫) –∏ 2 —Å–ª—É—á–∞–π–Ω—ã—Ö –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö
            function generateNewQuizOptions() {
                const correctOption = currentSoundId; // –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç - ID —Ç–æ–ª—å–∫–æ —á—Ç–æ –ø—Ä–æ–∏–≥—Ä–∞–Ω–Ω–æ–≥–æ –∑–≤—É–∫–∞
                const allOptions = numbers.map(n => n.id);
                
                // –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞–µ–º –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
                let wrongOptions = allOptions.filter(id => id !== correctOption);
                
                // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏ –±–µ—Ä–µ–º 2
                wrongOptions = wrongOptions.sort(() => Math.random() - 0.5).slice(0, 2);
                
                // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –æ–ø—Ü–∏–∏: –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π + 2 –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö
                let selectedOptions = [correctOption, ...wrongOptions];
                
                // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è
                selectedOptions = selectedOptions.sort(() => Math.random() - 0.5);

                quizOptions.innerHTML = '';
                quizFeedback.textContent = '';
                quizFeedback.className = 'quiz-feedback';
                
                selectedOptions.forEach(option => {
                    const optionBtn = document.createElement('div');
                    optionBtn.className = 'quiz-option';
                    optionBtn.dataset.option = option;
                    
                    // –í—Å—Ç–∞–≤–ª—è–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É —Ü–∏—Ñ—Ä—ã
                    optionBtn.innerHTML = `<img src="img/${option}.png" alt="–¶–∏—Ñ—Ä–∞ ${option}">`;
                    
                    optionBtn.addEventListener('click', () => {
                        // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: –Ω–µ–ª—å–∑—è –≤—ã–±—Ä–∞—Ç—å –æ—Ç–≤–µ—Ç, –ø–æ–∫–∞ –∏–≥—Ä–∞–µ—Ç –∑–≤—É–∫
                        if (isSoundPlaying) return; 
                        checkQuizAnswer(option);
                    });
                    
                    quizOptions.appendChild(optionBtn);
                });
                
                const allOptionsBtns = quizOptions.querySelectorAll('.quiz-option');
                allOptionsBtns.forEach(opt => {
                    opt.style.pointerEvents = 'auto';
                });
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞ –≤ —Ç–µ—Å—Ç–µ
            function checkQuizAnswer(selected) {
                // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: –Ω–µ–ª—å–∑—è –≤—ã–±—Ä–∞—Ç—å –æ—Ç–≤–µ—Ç, –ø–æ–∫–∞ –∏–≥—Ä–∞–µ—Ç –∑–≤—É–∫
                if (isSoundPlaying) return; 
                
                const allOptions = quizOptions.querySelectorAll('.quiz-option');
                allOptions.forEach(opt => {
                    // –û—Ç–∫–ª—é—á–∞–µ–º –∫–ª–∏–∫–∏ –Ω–∞ –≤—Å–µ—Ö –∫–Ω–æ–ø–∫–∞—Ö, –ø–æ–∫–∞ –∏–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞
                    opt.style.pointerEvents = 'none';
                });

                quizAttempts++;

                const selectedBtn = quizOptions.querySelector(`[data-option="${selected}"]`);
                
                // --- –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–≤–µ—Ç–∞ ---
                if (selected === currentSoundId) {
                    // –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                    selectedBtn.classList.add('correct');
                    quizFeedback.textContent = '–ü—Ä–∞–≤–∏–ª—å–Ω–æ! ‚úì';
                    quizFeedback.classList.remove('wrong');
                    quizFeedback.classList.add('correct');

                    // –ó–∞–≤–µ—Ä—à–∞–µ–º —Ç–µ—Å—Ç —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
                    setTimeout(() => {
                        quizModal.style.display = 'none';
                        canFlip = true;
                        isQuizActive = false;
                        currentQuizNumber = null;
                        currentMatchedCards = [];
                        currentSoundId = null; // –°–±—Ä–æ—Å ID –∑–≤—É–∫–∞
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –ø–∞—Ä
                        matchedPairs++;
                        pairsCount.textContent = matchedPairs;
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –ª–∏ –∏–≥—Ä–∞
                        if (matchedPairs === numbers.length) {
                            endGame();
                        }
                    }, 1000);

                } else {
                    // –ù–µ–≤–µ—Ä–Ω—ã–π –æ—Ç–≤–µ—Ç
                    selectedBtn.classList.add('wrong');
                    
                    quizFeedback.textContent = '–ù–µ–≤–µ—Ä–Ω–æ! –ü–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞.';
                    quizFeedback.classList.add('wrong');

                    setTimeout(() => {
                        selectedBtn.classList.remove('wrong');
                        
                        if (quizAttempts >= 3) {
                            // –ü–æ—Å–ª–µ 3 –ø–æ–ø—ã—Ç–æ–∫, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –∏ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
                            const correctBtn = quizOptions.querySelector(`[data-option="${currentSoundId}"]`);
                            if (correctBtn) {
                                correctBtn.classList.add('correct');
                            }
                            
                            quizFeedback.textContent = `–ü—Ä–∞–≤–∏–ª—å–Ω–æ, —ç—Ç–æ —Ü–∏—Ñ—Ä–∞ ${currentSoundId}! ‚úì`;
                            quizFeedback.classList.remove('wrong');
                            quizFeedback.classList.add('correct');
                            
                            // –ó–∞–≤–µ—Ä—à–∞–µ–º —Ç–µ—Å—Ç —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
                            setTimeout(() => {
                                quizModal.style.display = 'none';
                                canFlip = true;
                                isQuizActive = false;
                                currentQuizNumber = null;
                                currentMatchedCards = [];
                                currentSoundId = null; // –°–±—Ä–æ—Å ID –∑–≤—É–∫–∞

                                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –ø–∞—Ä
                                matchedPairs++;
                                pairsCount.textContent = matchedPairs;
                                
                                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –ª–∏ –∏–≥—Ä–∞
                                if (matchedPairs === numbers.length) {
                                    endGame();
                                }
                            }, 1000);

                        } else {
                            // –ú–µ–Ω—å—à–µ 3 –ø–æ–ø—ã—Ç–æ–∫ - –º–µ–Ω—è–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã
                            generateNewQuizOptions();
                            
                            // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –Ω–æ–≤—ã–π —Å–ª—É—á–∞–π–Ω—ã–π –∑–≤—É–∫ –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ä–∞—É–Ω–¥–∞
                            playRandomQuizSound();
                        }

                    }, 800);
                }
            }

            // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
            function endGame() {
                finalMoves.textContent = moves;
                winMessage.style.display = 'flex';
                createConfetti();
            }

            // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
            function createConfetti() {
                const colors = ['#ffcc00', '#ff6b35', '#42a5f5', '#4CAF50', '#9C27B0', '#FF4081'];

                for (let i = 0; i < 60; i++) {
                    const confetti = document.createElement('div');
                    confetti.style.position = 'fixed';
                    confetti.style.width = Math.random() * 15 + 8 + 'px';
                    confetti.style.height = Math.random() * 15 + 8 + 'px';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0%';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.top = '-30px';
                    confetti.style.zIndex = '1001';
                    confetti.style.opacity = '0.9';

                    document.body.appendChild(confetti);

                    const duration = 2000 + Math.random() * 2000;
                    const animation = confetti.animate([
                        {
                            transform: 'translateY(0) rotate(0deg)',
                            opacity: 1
                        },
                        {
                            transform: `translateY(${window.innerHeight + 50}px) rotate(${Math.random() * 720}deg)`,
                            opacity: 0
                        }
                    ], {
                        duration: duration,
                        easing: 'cubic-bezier(0.215, 0.610, 0.355, 1)'
                    });

                    animation.onfinish = () => {
                        if (confetti.parentNode) {
                            confetti.remove();
                        }
                    };
                }
            }

            // –ù–∞—á–∞–ª–æ –Ω–æ–≤–æ–π –∏–≥—Ä—ã
            function startNewGame() {
                flippedCards = [];
                moves = 0;
                matchedPairs = 0;
                movesCount.textContent = moves;
                pairsCount.textContent = matchedPairs;
                canFlip = true;
                currentQuizNumber = null;
                currentMatchedCards = [];
                quizAttempts = 0;
                currentSoundId = null; 
                isSoundPlaying = false;

                quizModal.style.display = 'none';
                winMessage.style.display = 'none';

                document.querySelectorAll('[style*="position: fixed"][style*="z-index: 1001"]').forEach(el => {
                    if (el.classList.length === 0) el.remove();
                });

                // –°–±—Ä–æ—Å –∏–∫–æ–Ω–∫–∏ –∑–≤—É–∫–∞
                const soundIcon = document.getElementById('replay-sound-btn');
                if (soundIcon) soundIcon.style.color = '#ff6b35'; 

                createCards();
            }

            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∑–≤—É–∫–∞
            function toggleSound() {
                soundEnabled = !soundEnabled;
                soundBtn.textContent = `–ó–≤—É–∫: ${soundEnabled ? '–í–∫–ª' : '–í—ã–∫–ª'}`;
            }

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–Ω–æ–ø–æ–∫
            restartBtn.addEventListener('click', startNewGame);
            playAgainBtn.addEventListener('click', startNewGame);
            soundBtn.addEventListener('click', toggleSound);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏—è –∑–≤—É–∫–∞ –≤ —Ç–µ—Å—Ç–µ
            replaySoundBtn.addEventListener('click', () => {
                if (currentSoundId && isQuizActive) {
                    playQuizSound(currentSoundId);
                }
            });

            // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
            document.addEventListener('touchmove', function(e) {
                if (e.scale !== 1) {
                    e.preventDefault();
                }
            }, { passive: false });

            // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω—é
            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
            });

            // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è iOS
            document.body.addEventListener('touchstart', function() {}, { passive: true });

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –Ω–∞—á–∞–ª–æ –∏–≥—Ä—ã
            initAudio();
            startNewGame();
        });
    </script>
</body>
</html>
